import java.time.LocalDate;
import java.util.*;
import java.util.stream.Collectors;

class TransactionManager {
    private List<Transaction> transactions;
    public TransactionManager() {
        this.transactions = new ArrayList<>();
    }
    public void addTransaction(Transaction transaction) {
        transactions.add(transaction);
    }
    public List<Transaction> getAllTransactions() {
        return new ArrayList<>(transactions);
    }
    public List<Transaction> getTransactionsByMonth(int year, int month) {
        return transactions.stream()
            .filter(t -> t.getDate().getYear() == year && t.getDate().getMonthValue() == month)
            .collect(Collectors.toList());
    }
    public double getTotalIncome(int year, int month) {
        return getTransactionsByMonth(year, month).stream()
            .filter(t -> t.getCategory() == TransactionCategory.PEMASUKAN)
            .mapToDouble(Transaction::getAmount)
            .sum();
    }
    public double getTotalExpense(int year, int month) {
        return getTransactionsByMonth(year, month).stream()
            .filter(t -> t.getCategory() == TransactionCategory.PENGELUARAN)
            .mapToDouble(Transaction::getAmount)
            .sum();
    }
    public double getTotalSavings(int year, int month) {
        return getTransactionsByMonth(year, month).stream()
            .filter(t -> t.getCategory() == TransactionCategory.SAVING)
            .mapToDouble(Transaction::getAmount)
            .sum();
    }
    public Map<String, Double> getExpensesByCategory(int year, int month) {
        return getTransactionsByMonth(year, month).stream()
            .filter(t -> t.getCategory() == TransactionCategory.PENGELUARAN)
            .collect(Collectors.groupingBy(
                Transaction::getSubCategory,
                Collectors.summingDouble(Transaction::getAmount)
            ));
    }
    public Map<String, Double> getIncomeByCategory(int year, int month) {
        return getTransactionsByMonth(year, month).stream()
            .filter(t -> t.getCategory() == TransactionCategory.PEMASUKAN)
            .collect(Collectors.groupingBy(
                Transaction::getSubCategory,
                Collectors.summingDouble(Transaction::getAmount)
            ));
    }
    public Map<String, Double> getSavingsByCategory(int year, int month) {
        return getTransactionsByMonth(year, month).stream()
            .filter(t -> t.getCategory() == TransactionCategory.SAVING)
            .collect(Collectors.groupingBy(
                Transaction::getSubCategory,
                Collectors.summingDouble(Transaction::getAmount)
            ));
    }
}